# Security Configuration for Legal LLM Supreme Court System
# Copy this file to .env and fill in the values

# ============================================================================
# JWT Authentication
# ============================================================================
# Secret key for JWT token signing (generate with: openssl rand -hex 32)
JWT_SECRET_KEY=your-secret-key-here-change-this-in-production

# JWT token expiration time in minutes
JWT_EXPIRATION_MINUTES=60

# JWT algorithm
JWT_ALGORITHM=HS256

# ============================================================================
# Rate Limiting
# ============================================================================
# Global rate limit (requests per minute)
RATE_LIMIT_PER_MINUTE=100

# Burst size (max requests in short burst)
RATE_LIMIT_BURST=20

# ============================================================================
# CORS Configuration
# ============================================================================
# Allowed origins (comma-separated, NO wildcards in production)
# Development example:
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080

# Production example:
# ALLOWED_ORIGINS=https://yourdomain.com,https://app.yourdomain.com

# ============================================================================
# File Upload Security
# ============================================================================
# Maximum file upload size in bytes (10MB default)
MAX_FILE_SIZE=10485760

# Allowed upload directory (for batch ingestion)
ALLOWED_UPLOAD_BASE=/app/uploads

# ============================================================================
# Request Security
# ============================================================================
# Maximum request body size in bytes (10MB default)
MAX_REQUEST_SIZE=10485760

# Request timeout in seconds
REQUEST_TIMEOUT=60

# ============================================================================
# Input Validation
# ============================================================================
# Maximum text input lengths
MAX_QUERY_LENGTH=1000
MAX_FACTS_LENGTH=10000
MAX_ISSUE_LENGTH=1000

# ============================================================================
# TLS/HTTPS Configuration
# ============================================================================
# Enable HTTPS (set to true in production)
ENABLE_HTTPS=false

# SSL certificate paths (required if ENABLE_HTTPS=true)
SSL_CERT_PATH=/path/to/cert.pem
SSL_KEY_PATH=/path/to/key.pem

# ============================================================================
# Data Encryption
# ============================================================================
# Encryption key for sensitive data (generate with: openssl rand -hex 32)
ENCRYPTION_KEY=your-encryption-key-here-change-this-in-production

# ============================================================================
# Logging Configuration
# ============================================================================
# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Enable PII redaction in logs
ENABLE_PII_REDACTION=true

# Log file path
LOG_FILE_PATH=/var/log/legal-llm/app.log

# ============================================================================
# External Services
# ============================================================================
# OpenAI API Key (for opinion generation)
OPENAI_API_KEY=your-openai-api-key-here

# Qdrant Vector Database
QDRANT_HOST=localhost
QDRANT_PORT=6333
QDRANT_API_KEY=

# Redis Cache
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# ============================================================================
# Service URLs (Internal)
# ============================================================================
EMBEDDING_SERVICE_URL=http://localhost:8001
INGESTION_SERVICE_URL=http://localhost:8002
SEARCH_SERVICE_URL=http://localhost:8003
PREDICTION_SERVICE_URL=http://localhost:8004
OPINION_SERVICE_URL=http://localhost:8005
OCR_SERVICE_URL=http://localhost:8006

# ============================================================================
# Production Security Checklist
# ============================================================================
# Before deploying to production, ensure:
# [ ] JWT_SECRET_KEY is changed to a strong random value
# [ ] ENCRYPTION_KEY is changed to a strong random value
# [ ] ALLOWED_ORIGINS contains only your actual domains (no wildcards)
# [ ] ENABLE_HTTPS is set to true
# [ ] SSL certificates are properly configured
# [ ] All API keys are stored in a secrets manager (not in .env)
# [ ] LOG_LEVEL is set to INFO or WARNING
# [ ] ENABLE_PII_REDACTION is set to true
# [ ] Rate limits are appropriate for your use case
# [ ] File upload limits are appropriate for your use case
